(this["webpackJsonptron-react-poll-dapp"]=this["webpackJsonptron-react-poll-dapp"]||[]).push([[0],{113:function(e,n,t){},136:function(e,n){},147:function(e,n){},251:function(e,n,t){"use strict";t.r(n);var r,a,o,c,i,s,u,l,d,f,b,p=t(4),h=t(44),j=t.n(h),x=t(26),m=t(101),g={wallet:null},v=Object(m.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,n=arguments.length>1?arguments[1]:void 0;return"connect"===n.type?{wallet:n.wallet}:"disconnect"===n.type?{wallet:null}:e})),w=(t(113),t(38)),O=t(10),y=t(12),C=t(31),D=t.n(C),T=t(13),k=t(6),P=t(52).getUserTronWallet,z=T.a.div(r||(r=Object(y.a)(["\n  box-sizing: border-box;\n  width:100%;\n  height:64px;\n  color: #fff;\n  background-color: #3f51b5;\n  display: flex;\n  align-items: center;\n  padding-left: 1.4rem;\n  padding-right: 1.4rem;\n  font-size: 21px;\n  svg{\n    padding-right:1.4rem;\n    fill: currentColor;\n    width: 1em;\n    height: 1em;\n    display: inline-block;\n    font-size: 1.5rem;\n    transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n    flex-shrink: 0;\n    user-select: none;\n  }\n  span.title{\n    flex-grow:1;\n  }\n  span.menu{\n    cursor:pointer;\n    font-size: 16px;\n    margin-left:0.7rem;\n    margin-right:0.7rem;\n  }\n\n  span.wallet{\n    position:absolute;\n    right:24px;\n    top:68px;\n    color:#000;\n    font-size:12px;\n    cursor:pointer\n  }\n  span.wallet.connected{\n    cursor:default;\n  }\n"]))),S=function(){var e=Object(O.f)(),n=Object(O.g)(),t=Object(x.c)((function(e){return e.wallet})),r=Object(x.b)();return Object(k.jsxs)(z,{children:[Object(k.jsx)("svg",{focusable:"false",viewBox:"0 0 24 24","aria-hidden":"true",children:Object(k.jsx)("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"})}),Object(k.jsx)("span",{className:"title",children:"Tron React Poll DAPP"}),"/"===n.pathname&&Object(k.jsx)("span",{className:"menu",onClick:function(){e.push("/create-poll")},children:"Create a Poll"}),"/"!==n.pathname&&Object(k.jsx)("span",{className:"menu",onClick:function(){e.push("/")},children:"HOME"}),!t&&Object(k.jsx)("span",{className:"wallet",onClick:function(){var e=P();e?r({type:"connect",wallet:e}):(D()("Error","Install tronlink to use this DAPP","error"),r({type:"disconnect"}))},children:"Connect to Tronlink"}),t&&Object(k.jsxs)("span",{className:"wallet connected",children:["Connected: ",t]})]})},K=t(23),V=T.a.div(a||(a=Object(y.a)(["\n    padding: 1rem;\n    font-size: 2rem;\n    border-bottom: 1px solid #eee;\n    margin: 1rem;\n    cursor: pointer;\n    &:hover{\n        opacity:0.8;\n    }\n"]))),E=function(e){return Object(k.jsx)(V,{onClick:e.onSelect,children:e.poll.question})},H=T.a.div(o||(o=Object(y.a)(["\n    padding: 1rem;\n    border: 1px solid #eee;\n    margin: 2rem auto;\n    max-width:1280px;\n"]))),A=function(e){return Object(k.jsx)(H,{children:e.children})},W=T.a.div(c||(c=Object(y.a)(["\nmargin:auto;\n&,\n&:after {\n  border-radius: 50%;\n  overflow: hidden;\n  width: ","em;\n  height: ","em;\n}\n& {\n  font-size: 10px;\n  position: relative;\n  text-indent: -9999em;\n  border-top: ","em solid rgba(255, 255, 255, 0.2);\n  border-right: ","em solid rgba(255, 255, 255, 0.2);\n  border-bottom: ","em solid rgba(255, 255, 255, 0.2);\n  border-left: ","em solid #000000;\n  border-left-color:inherit;\n  -webkit-transform: translateZ(0);\n  -ms-transform: translateZ(0);\n  transform: translateZ(0);\n  -webkit-animation: load8 1.1s infinite linear;\n  animation: load8 1.1s infinite linear;\n}\n@-webkit-keyframes load8 {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n@keyframes load8 {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n"])),(function(e){return 2*e.size}),(function(e){return 2*e.size}),(function(e){return.22*e.size}),(function(e){return.22*e.size}),(function(e){return.22*e.size}),(function(e){return.22*e.size})),M=function(e){var n;return Object(k.jsx)(W,{size:null!==(n=e.size)&&void 0!==n?n:5,children:"Loading..."})},N=t(58),F=N.getPoll,G=N.getPollCount,q=function(){var e=Object(p.useState)([]),n=Object(K.a)(e,2),t=n[0],r=n[1],a=Object(O.f)(),o=Object(p.useState)(!1),c=Object(K.a)(o,2),i=c[0],s=c[1];Object(p.useEffect)((function(){s(!0),G().then((function(e){var n=Array(e).fill().map((function(e,n){return n}));Promise.all(n.map((function(e){return F(e)}))).then((function(e){s(!1);var n=[];e.forEach((function(e){n.push(e)})),r(n)})).catch((function(e){s(!1),console.log(e)}))})).catch((function(e){s(!1),console.log(e)}))}),[]);return Object(k.jsxs)(A,{children:[!i&&t.length>0&&t.map((function(e,n){return Object(k.jsx)(E,{poll:e,onSelect:function(){return e=n,void a.push("/poll/"+e);var e}},n)})),!i&&0===t.length&&Object(k.jsx)("h1",{children:"There is no Poll on this DAPP."}),i&&Object(k.jsx)(M,{size:"5"})]})},I=t(32),Y=T.a.button(i||(i=Object(y.a)(["\n  cursor: ",";\n  width: 100%;\n  height: 48px;\n  margin-top: 36px;\n  font-weight: bold;\n  font-size: 1.1rem;\n  background-color: #3f51b5;\n  opacity: ",";\n  color: white;\n  outline: none;\n  border: none;\n  ","\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"])),(function(e){return e.disabled?"not-allowed":"pointer"}),(function(e){return e.disabled?.5:1}),(function(e){return!e.disabled&&"\n    &:hover{\n      opacity: 0.9;\n    }\n  "})),B=function(e){return Object(k.jsx)(Y,Object(I.a)(Object(I.a)({},e),{},{children:e.children}))},L=t(58),Q=L.getPoll,R=L.getVoteCounter,Z=L.vote,_=t(52),J=_.getTransactionInfo,X=_.tronHexToAscii,U=T.a.div(s||(s=Object(y.a)(["\n  margin-top: 24px;\n  padding: 1rem;\n"]))),$=T.a.div(u||(u=Object(y.a)(["\n  font-size: 2.5rem;\n  margin-bottom: 1rem;\n"]))),ee=T.a.div(l||(l=Object(y.a)(["\n  display:flex;\n  justify-content:space-between;\n"]))),ne=T.a.div(d||(d=Object(y.a)(["\n  position: relative;\n  border: 1px solid #eee;\n  cursor: pointer;\n  padding: 8px;\n  margin-top: 64px;\n  &:hover {\n      background-color: azure;\n  }\n"]))),te=T.a.div(f||(f=Object(y.a)(["\n  position:absolute;\n  top:-24px;\n  left:0;\n  width:100%;\n  span.color{\n    background-image:linear-gradient(to right,red 90%,white);\n    width:","%;\n    position:absolute;\n    top:16px;\n    height:5px;\n    left:0;\n    z-index:1;\n  }\n  span.text{\n    top:0;\n    right:0;\n    z-index:1;\n    color:blue;\n    position:absolute;\n  }\n"])),(function(e){var n=e.size;return void 0===n?0:n})),re=function(e){var n=e.match.params.index,t=Object(p.useState)(null),r=Object(K.a)(t,2),a=r[0],o=r[1],c=Object(p.useState)(null),i=Object(K.a)(c,2),s=i[0],u=i[1],l=Object(p.useState)(null),d=Object(K.a)(l,2),f=d[0],b=d[1],h=Object(p.useState)(!1),j=Object(K.a)(h,2),m=j[0],g=j[1],v=Object(p.useState)(!1),w=Object(K.a)(v,2),O=w[0],y=w[1],C=Object(x.c)((function(e){return e.wallet}));Object(p.useEffect)((function(){y(!0),Promise.all([Q(n),R(n)]).then((function(e){y(!1),o(e[0]),u(e[1])})).catch((function(e){y(!1),console.log(e)}))}),[n]);return Object(k.jsx)(A,{children:Object(k.jsxs)(U,{children:[a&&Object(k.jsxs)("div",{children:[Object(k.jsx)($,{children:a.question}),Object(k.jsxs)(ee,{children:[Object(k.jsxs)("span",{children:["Start-date: ",new Date(1e3*a.startDate).toISOString().slice(0,10)]}),Object(k.jsxs)("span",{children:["Finish-date: ",new Date(1e3*a.finishDate).toISOString().slice(0,10)]})]}),[1,2,3,4].map((function(e){return Object(k.jsxs)(ne,{onClick:function(){return b(e)},children:[Object(k.jsxs)(te,{size:s&&s["answer".concat(e,"VoteCounter")]>0?Math.floor(100*s["answer".concat(e,"VoteCounter")]/(s.answer1VoteCounter+s.answer2VoteCounter+s.answer3VoteCounter+s.answer4VoteCounter)):0,children:[Object(k.jsx)("span",{className:"color",children:"\xa0"}),Object(k.jsxs)("span",{className:"text",children:[s?s["answer".concat(e,"VoteCounter")]:"no "," Vote",s&&s["answer".concat(e,"VoteCounter")]>1?"s":""]})]}),Object(k.jsx)("input",{id:"answer".concat(e),type:"radio",name:"answer",value:e,checked:f===e,onChange:function(e){b(+e.target.value)}}),Object(k.jsx)("label",{htmlFor:"answer".concat(e),children:a["answer".concat(e)]})]},e)})),Object(k.jsx)("div",{children:Object(k.jsx)(B,{onClick:function(){C?(console.log(f),g(!0),Z(n,f-1).then((function(e){console.log(e),setTimeout((function(){J(e).then((function(e){if(g(!1),console.log(e),"FAILED"===e.result){var n="";n=n+X(e.resMessage)+", ",n=(n+=X(e.contractResult[0])).replace(/[^\w\s]/gi,""),D()("Error",n,"error")}})).catch((function(e){g(!1),console.log(e)}))}),1e4)})).catch((function(e){g(!1),console.log(e)}))):D()("Error","Connect to your wallet!","error")},disabled:m||null===f,children:m?Object(k.jsx)(M,{size:"1"}):"Vote"})})]}),O&&Object(k.jsx)(M,{size:"5"})]})})},ae=t(46),oe=t(58).createPoll,ce=T.a.div(b||(b=Object(y.a)(["\n  display: flex;\n  flex-direction: column;\n  height:76px;\n  input{\n    height:36px;\n  }\n"]))),ie=function(){var e=Object(O.f)(),n=Object(x.c)((function(e){return e.wallet})),t=Object(p.useState)({question:"",answer1:"",answer2:"",answer3:"",answer4:"",startDate:"",finishDate:""}),r=Object(K.a)(t,2),a=r[0],o=r[1],c=function(e,n){o(Object(I.a)(Object(I.a)({},a),{},Object(ae.a)({},e,n)))};return Object(k.jsxs)(A,{children:[["question","answer1","answer2","answer3","answer4"].map((function(e){return Object(k.jsxs)(ce,{children:[Object(k.jsx)("label",{htmlFor:e,children:e}),Object(k.jsx)("input",{type:"text",value:a[e],onChange:function(n){return c(e,n.target.value)},id:e})]},e)})),Object(k.jsxs)(ce,{children:[Object(k.jsx)("label",{htmlFor:"start-date",children:"Start Date"}),Object(k.jsx)("input",{type:"date",value:a.startDate,onChange:function(e){return c("startDate",e.target.value)},id:"start-date"})]}),Object(k.jsxs)(ce,{children:[Object(k.jsx)("label",{htmlFor:"finish-date",children:"Finish Date"}),Object(k.jsx)("input",{type:"date",value:a.finishDate,onChange:function(e){return c("finishDate",e.target.value)},id:"finish-date"})]}),Object(k.jsx)(B,{onClick:function(){return function(){if(n){var t=Object(I.a)({},a);t.startDate=Math.floor(new Date(t.startDate).getTime()/1e3),t.finishDate=Math.floor(new Date(t.finishDate).getTime()/1e3),oe(t.question,t.answer1,t.answer2,t.answer3,t.answer4,t.startDate,t.finishDate).then((function(n){e.push("/")})).catch((function(e){console.log(e)}))}else D()("Error","Connect to your wallet!","error")}()},disabled:!(""!==a.question.trim()&&""!==a.answer1.trim()&&""!==a.answer2.trim()&&""!==a.answer3.trim()&&""!==a.answer4.trim()&&""!==a.startDate.trim()&&""!==a.finishDate.trim()&&a.startDate.trim()>=(new Date).toISOString().slice(0,10)&&a.startDate.trim()<a.finishDate.trim()),children:"Save"})]})},se=function(){return Object(k.jsx)("h1",{children:"NotFound"})};var ue=function(){return Object(k.jsx)("div",{children:Object(k.jsxs)(w.a,{children:[Object(k.jsx)(S,{}),Object(k.jsxs)(O.c,{children:[Object(k.jsx)(O.a,{path:"/create-poll",children:Object(k.jsx)(ie,{})}),Object(k.jsx)(O.a,{path:"/poll/:index",component:re}),Object(k.jsx)(O.a,{path:"/",exact:!0,children:Object(k.jsx)(q,{})}),Object(k.jsx)(O.a,{path:"/",children:Object(k.jsx)(se,{})})]})]})})};j.a.render(Object(k.jsx)(x.a,{store:v,children:Object(k.jsx)(ue,{})}),document.getElementById("root"))},52:function(e,n,t){"use strict";t.r(n),t.d(n,"getGeneralTronWeb",(function(){return s})),t.d(n,"getTronContract",(function(){return l})),t.d(n,"tronHexToDecimal",(function(){return d})),t.d(n,"tronHexToAscii",(function(){return f})),t.d(n,"getUserTronWallet",(function(){return b})),t.d(n,"getTransactionInfo",(function(){return p}));var r=t(2),a=t.n(r),o=t(25),c=t(116),i=t(93),s=function(){var e=c.providers.HttpProvider,n=new e(i.tronFullNode),t=new e(i.tronSolidityNode),r=new e(i.tronEventServer);return new c(n,t,r,i.tronGeneralPrivateKey)},u=function(){if(window&&window.tronWeb&&window.tronWeb.defaultAddress.base58)return window.tronWeb},l=function(){var e=Object(o.a)(a.a.mark((function e(n,t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="general"===t?s():u(),e.abrupt("return",r.contract().at(n));case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),d=function(e){return c.toDecimal(e)},f=function(e){return c.toAscii(e)},b=function(){if(window.tronWeb&&window.tronWeb.defaultAddress.base58)return window.tronWeb.defaultAddress.base58},p=function(){var e=Object(o.a)(a.a.mark((function e(n){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s(),e.abrupt("return",t.trx.getTransactionInfo(n));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},58:function(e,n,t){"use strict";t.r(n),t.d(n,"createPoll",(function(){return s})),t.d(n,"getPoll",(function(){return u})),t.d(n,"getPollCount",(function(){return l})),t.d(n,"getVoteCounter",(function(){return d})),t.d(n,"vote",(function(){return f})),t.d(n,"setToken",(function(){return b}));var r=t(2),a=t.n(r),o=t(25),c=t(52),i=t(93),s=function(){var e=Object(o.a)(a.a.mark((function e(n,t,r,o,s,u,l){var d,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getTronContract(i.tronPollDappContract,"user");case 2:return d=e.sent,e.prev=3,e.next=6,d.createPoll(n,t,r,o,s,u,l).send();case 6:return f=e.sent,e.abrupt("return",f);case 10:e.prev=10,e.t0=e.catch(3),console.log("error",e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(n,t,r,a,o,c,i){return e.apply(this,arguments)}}(),u=function(){var e=Object(o.a)(a.a.mark((function e(n){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getTronContract(i.tronPollDappContract,"general");case 2:return t=e.sent,e.next=5,t.polls(n).call();case 5:return(r=e.sent).startDate=c.tronHexToDecimal(r.startDate._hex),r.finishDate=c.tronHexToDecimal(r.finishDate._hex),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),l=function(){var e=Object(o.a)(a.a.mark((function e(){var n,t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getTronContract(i.tronPollDappContract,"general");case 2:return n=e.sent,e.next=5,n.getPollCount().call();case 5:return t=e.sent,e.abrupt("return",c.tronHexToDecimal(t._hex));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(o.a)(a.a.mark((function e(n){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getTronContract(i.tronPollDappContract,"general");case 2:return t=e.sent,e.next=5,t.voteCounters(n).call();case 5:return(r=e.sent).answer1VoteCounter=c.tronHexToDecimal(r.answer1VoteCounter._hex),r.answer2VoteCounter=c.tronHexToDecimal(r.answer2VoteCounter._hex),r.answer3VoteCounter=c.tronHexToDecimal(r.answer3VoteCounter._hex),r.answer4VoteCounter=c.tronHexToDecimal(r.answer4VoteCounter._hex),e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),f=function(){var e=Object(o.a)(a.a.mark((function e(n,t){var r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getTronContract(i.tronPollDappContract,"user");case 2:return r=e.sent,e.prev=3,e.next=6,r.vote(n,t).send();case 6:return o=e.sent,e.abrupt("return",o);case 10:e.prev=10,e.t0=e.catch(3),console.log("error",e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(n,t){return e.apply(this,arguments)}}(),b=function(){var e=Object(o.a)(a.a.mark((function e(){var n,t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getTronContract(i.tronPollDappContract,"general");case 2:return n=e.sent,e.prev=3,e.next=6,n.setToken(i.tronPollTokenContract).send();case 6:return t=e.sent,e.abrupt("return",t);case 10:e.prev=10,e.t0=e.catch(3),console.log("error",e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}()},93:function(e,n,t){"use strict";t.r(n),t.d(n,"tronPollDappContract",(function(){return r})),t.d(n,"tronPollTokenContract",(function(){return a})),t.d(n,"tronAccounts",(function(){return o})),t.d(n,"tronGeneralPublicKey",(function(){return c})),t.d(n,"tronGeneralPrivateKey",(function(){return i})),t.d(n,"tronFullNode",(function(){return s})),t.d(n,"tronSolidityNode",(function(){return u})),t.d(n,"tronEventServer",(function(){return l}));var r="TJ8MBRtmiArKmMDZPP5itVwesHSbAPCJhY",a="TLgt7Zkh56mJvqVFAYyshgvYMqjk14gXSk",o=[{publicKey:"TG31Eya5GywMYV2rwq3rwGbep4eoykWREP",privateKey:"d8db4dfed48fc23884a1bde2e654cf7e6498ad023892ddbafb3c013573e2bd74"},{publicKey:"TTH598f947PU5sXz33PmfPPergcw11jy2S",privateKey:"feddacfb92d2817811cee05947ee48a2733e746c6309d8101d248df78cdf7679"},{publicKey:"TW9srDmAC2ydc8WfNaLYMnS63iQiWKfgLG",privateKey:"fccd3e23c114644d002013f69d3cd0d1d6e8261989b3131d3d02a507e7b4f018"},{publicKey:"TT88NtTzYT56fG7avWGrgBkDvrY6MX7rWb",privateKey:"378c5553f4ed02b995e5395c3057f2b6bc72b26a854e8353fc2211daa9ff1a20"},{publicKey:"TG6i13mQLMM7SrfD8TRSxxDZBQEpUizShs",privateKey:"a7c2179a95ea189914517c43adf7b9e130ee27c14e2e81f55975be5b1d59c869"},{publicKey:"TQnwk8eSZjFVH9JhzKkaPnV27r6Xxhg4u1",privateKey:"a2cc6886212962255777cb1fcc393d12613e60cea4f95877ad1b1bb7e75e8f29"},{publicKey:"THagkrFvo2xoASnRgpsMqvusBdAn7DQTcc",privateKey:"bea9b1682374a15c351704b27c221155759f72fefaec2d9d52054ebb35569363"},{publicKey:"TPiBEmProxmvwuEbPkYe8WCE5EEAHM5zeg",privateKey:"7d134b76c1a878bc0318c8d1aacb6f41c46d1ba9a8d8ba2f2cd95b9a81cbc430"},{publicKey:"TCXaE1cAYbHM9X3Q8mKDAWU3rq7mPb1vxt",privateKey:"4d4695179f5190a53eaa3b1d7cda972f385fafaff2bd90011f67c7c83aa2a7c3"},{publicKey:"TWEPD2Li4R4NQ4GrrrWBp4bK7xgsaHs24W",privateKey:"5c6c45c09715d1b34249b1b7238c8b1a14e7ffbe71d331caa90c6a2017ebe178"}],c=o[0].publicKey,i=o[0].privateKey,s="https://api.shasta.trongrid.io",u="https://api.shasta.trongrid.io",l="https://api.shasta.trongrid.io"}},[[251,1,2]]]);
//# sourceMappingURL=main.f054029b.chunk.js.map