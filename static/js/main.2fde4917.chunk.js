(this["webpackJsonptron-react-poll-dapp"]=this["webpackJsonptron-react-poll-dapp"]||[]).push([[0],{114:function(e,t,n){},137:function(e,t){},148:function(e,t){},252:function(e,t,n){"use strict";n.r(t);var r,a,o,c,i,s,l,u,d,p,b,f=n(4),h=n(44),j=n.n(h),x=n(26),m=n(102),g={wallet:null},v=Object(m.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;return"connect"===t.type?{wallet:t.wallet}:"disconnect"===t.type?{wallet:null}:e})),w=(n(114),n(38)),O=n(10),y=n(12),C=n(31),D=n.n(C),T=n(13),k=n(6),P=n(52).getUserTronWallet,z=T.a.div(r||(r=Object(y.a)(["\n  box-sizing: border-box;\n  width:100%;\n  height:64px;\n  color: #fff;\n  background-color: #3f51b5;\n  display: flex;\n  align-items: center;\n  padding-left: 1.4rem;\n  padding-right: 1.4rem;\n  font-size: 21px;\n  svg{\n    padding-right:1.4rem;\n    fill: currentColor;\n    width: 1em;\n    height: 1em;\n    display: inline-block;\n    font-size: 1.5rem;\n    transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;\n    flex-shrink: 0;\n    user-select: none;\n  }\n  span.title{\n    flex-grow:1;\n  }\n  span.menu{\n    cursor:pointer;\n    font-size: 16px;\n    margin-left:0.7rem;\n    margin-right:0.7rem;\n  }\n\n  span.wallet{\n    position:absolute;\n    right:24px;\n    top:68px;\n    color:#000;\n    font-size:12px;\n    cursor:pointer\n  }\n  span.wallet.connected{\n    cursor:default;\n  }\n"]))),S=function(){var e=Object(O.f)(),t=Object(O.g)(),n=Object(x.c)((function(e){return e.wallet})),r=Object(x.b)();return Object(k.jsxs)(z,{children:[Object(k.jsx)("svg",{focusable:"false",viewBox:"0 0 24 24","aria-hidden":"true",children:Object(k.jsx)("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"})}),Object(k.jsx)("span",{className:"title",children:"Tron React Poll DAPP"}),"/"===t.pathname&&Object(k.jsx)("span",{className:"menu",onClick:function(){e.push("/create-poll")},children:"Create a Poll"}),"/"!==t.pathname&&Object(k.jsx)("span",{className:"menu",onClick:function(){e.push("/")},children:"HOME"}),!n&&Object(k.jsx)("span",{className:"wallet",onClick:function(){var e=P();e?r({type:"connect",wallet:e}):(D()("Error","Install tronlink to use this DAPP","error"),r({type:"disconnect"}))},children:"Connect to Tronlink"}),n&&Object(k.jsxs)("span",{className:"wallet connected",children:["Connected: ",n]})]})},K=n(23),V=T.a.div(a||(a=Object(y.a)(["\n    padding: 1rem;\n    font-size: 2rem;\n    border-bottom: 1px solid #eee;\n    margin: 1rem;\n    cursor: pointer;\n    &:hover{\n        opacity:0.8;\n    }\n"]))),E=function(e){return Object(k.jsx)(V,{onClick:e.onSelect,children:e.poll.question})},H=T.a.div(o||(o=Object(y.a)(["\n    padding: 1rem;\n    border: 1px solid #eee;\n    margin: 2rem auto;\n    max-width:1280px;\n"]))),A=function(e){return Object(k.jsx)(H,{children:e.children})},W=T.a.div(c||(c=Object(y.a)(["\nmargin:auto;\n&,\n&:after {\n  border-radius: 50%;\n  overflow: hidden;\n  width: ","em;\n  height: ","em;\n}\n& {\n  font-size: 10px;\n  position: relative;\n  text-indent: -9999em;\n  border-top: ","em solid rgba(255, 255, 255, 0.2);\n  border-right: ","em solid rgba(255, 255, 255, 0.2);\n  border-bottom: ","em solid rgba(255, 255, 255, 0.2);\n  border-left: ","em solid #000000;\n  border-left-color:inherit;\n  -webkit-transform: translateZ(0);\n  -ms-transform: translateZ(0);\n  transform: translateZ(0);\n  -webkit-animation: load8 1.1s infinite linear;\n  animation: load8 1.1s infinite linear;\n}\n@-webkit-keyframes load8 {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n@keyframes load8 {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg);\n  }\n}\n"])),(function(e){return 2*e.size}),(function(e){return 2*e.size}),(function(e){return.22*e.size}),(function(e){return.22*e.size}),(function(e){return.22*e.size}),(function(e){return.22*e.size})),M=function(e){var t;return Object(k.jsx)(W,{size:null!==(t=e.size)&&void 0!==t?t:5,children:"Loading..."})},N=n(58),F=N.getPoll,G=N.getPollCount,q=function(){var e=Object(f.useState)([]),t=Object(K.a)(e,2),n=t[0],r=t[1],a=Object(O.f)(),o=Object(f.useState)(!1),c=Object(K.a)(o,2),i=c[0],s=c[1];Object(f.useEffect)((function(){s(!0),G().then((function(e){var t=Array(e).fill().map((function(e,t){return t}));Promise.all(t.map((function(e){return F(e)}))).then((function(e){s(!1);var t=[];e.forEach((function(e){t.push(e)})),r(t)})).catch((function(e){s(!1),console.log(e)}))})).catch((function(e){s(!1),console.log(e)}))}),[]);return Object(k.jsxs)(A,{children:[!i&&n.length>0&&n.map((function(e,t){return Object(k.jsx)(E,{poll:e,onSelect:function(){return e=t,void a.push("/poll/"+e);var e}},t)})),!i&&0===n.length&&Object(k.jsx)("h1",{children:"There is no Poll on this DAPP."}),i&&Object(k.jsx)(M,{size:"5"})]})},I=n(32),Y=T.a.button(i||(i=Object(y.a)(["\n  cursor: ",";\n  width: 100%;\n  height: 48px;\n  margin-top: 36px;\n  font-weight: bold;\n  font-size: 1.1rem;\n  background-color: #3f51b5;\n  opacity: ",";\n  color: white;\n  outline: none;\n  border: none;\n  ","\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"])),(function(e){return e.disabled?"not-allowed":"pointer"}),(function(e){return e.disabled?.5:1}),(function(e){return!e.disabled&&"\n    &:hover{\n      opacity: 0.9;\n    }\n  "})),B=function(e){return Object(k.jsx)(Y,Object(I.a)(Object(I.a)({},e),{},{children:e.children}))},L=n(58),Q=L.getPoll,R=L.getVoteCounter,Z=L.vote,_=n(52),J=_.getTransactionInfo,X=_.tronHexToAscii,U=T.a.div(s||(s=Object(y.a)(["\n  margin-top: 24px;\n  padding: 1rem;\n"]))),$=T.a.div(l||(l=Object(y.a)(["\n  font-size: 2.5rem;\n  margin-bottom: 1rem;\n"]))),ee=T.a.div(u||(u=Object(y.a)(["\n  display:flex;\n  justify-content:space-between;\n"]))),te=T.a.div(d||(d=Object(y.a)(["\n  position: relative;\n  border: 1px solid #eee;\n  cursor: pointer;\n  padding: 8px;\n  margin-top: 64px;\n  &:hover {\n      background-color: azure;\n  }\n"]))),ne=T.a.div(p||(p=Object(y.a)(["\n  position:absolute;\n  top:-24px;\n  left:0;\n  width:100%;\n  span.color{\n    background-image:linear-gradient(to right,red 90%,white);\n    width:","%;\n    position:absolute;\n    top:16px;\n    height:5px;\n    left:0;\n    z-index:1;\n  }\n  span.text{\n    top:0;\n    right:0;\n    z-index:1;\n    color:blue;\n    position:absolute;\n  }\n"])),(function(e){var t=e.size;return void 0===t?0:t})),re=function(e){var t=e.match.params.index,n=Object(f.useState)(null),r=Object(K.a)(n,2),a=r[0],o=r[1],c=Object(f.useState)(null),i=Object(K.a)(c,2),s=i[0],l=i[1],u=Object(f.useState)(null),d=Object(K.a)(u,2),p=d[0],b=d[1],h=Object(f.useState)(!1),j=Object(K.a)(h,2),m=j[0],g=j[1],v=Object(f.useState)(!1),w=Object(K.a)(v,2),O=w[0],y=w[1],C=Object(x.c)((function(e){return e.wallet}));Object(f.useEffect)((function(){y(!0),Promise.all([Q(t),R(t)]).then((function(e){y(!1),o(e[0]),l(e[1])})).catch((function(e){y(!1),console.log(e)}))}),[t]);return Object(k.jsx)(A,{children:Object(k.jsxs)(U,{children:[a&&Object(k.jsxs)("div",{children:[Object(k.jsx)($,{children:a.question}),Object(k.jsxs)(ee,{children:[Object(k.jsxs)("span",{children:["Start-date: ",new Date(1e3*a.startDate).toISOString().slice(0,10)]}),Object(k.jsxs)("span",{children:["Finish-date: ",new Date(1e3*a.finishDate).toISOString().slice(0,10)]})]}),[1,2,3,4].map((function(e){return Object(k.jsxs)(te,{onClick:function(){return b(e)},children:[Object(k.jsxs)(ne,{size:s&&s["answer".concat(e,"VoteCounter")]>0?Math.floor(100*s["answer".concat(e,"VoteCounter")]/(s.answer1VoteCounter+s.answer2VoteCounter+s.answer3VoteCounter+s.answer4VoteCounter)):0,children:[Object(k.jsx)("span",{className:"color",children:"\xa0"}),Object(k.jsxs)("span",{className:"text",children:[s?s["answer".concat(e,"VoteCounter")]:"no "," Vote",s&&s["answer".concat(e,"VoteCounter")]>1?"s":""]})]}),Object(k.jsx)("input",{id:"answer".concat(e),type:"radio",name:"answer",value:e,checked:p===e,onChange:function(e){b(+e.target.value)}}),Object(k.jsx)("label",{htmlFor:"answer".concat(e),children:a["answer".concat(e)]})]},e)})),Object(k.jsx)("div",{children:Object(k.jsx)(B,{onClick:function(){C?(console.log(p),g(!0),Z(t,p-1).then((function(e){console.log(e),setTimeout((function(){J(e).then((function(e){if(g(!1),console.log(e),"FAILED"===e.result){var t="";t=t+X(e.resMessage)+", ",t=(t+=X(e.contractResult[0])).replace(/[^\w\s]/gi,""),D()("Error",t,"error")}})).catch((function(e){g(!1),console.log(e)}))}),1e4)})).catch((function(e){g(!1),console.log(e)}))):D()("Error","Connect to your wallet!","error")},disabled:m||null===p,children:m?Object(k.jsx)(M,{size:"1"}):"Vote"})})]}),O&&Object(k.jsx)(M,{size:"5"})]})})},ae=n(46),oe=n(58).createPoll,ce=T.a.div(b||(b=Object(y.a)(["\n  display: flex;\n  flex-direction: column;\n  height:76px;\n  input{\n    height:36px;\n  }\n"]))),ie=function(){var e=Object(O.f)(),t=Object(x.c)((function(e){return e.wallet})),n=Object(f.useState)({question:"",answer1:"",answer2:"",answer3:"",answer4:"",startDate:"",finishDate:""}),r=Object(K.a)(n,2),a=r[0],o=r[1],c=function(e,t){o(Object(I.a)(Object(I.a)({},a),{},Object(ae.a)({},e,t)))};return Object(k.jsxs)(A,{children:[["question","answer1","answer2","answer3","answer4"].map((function(e){return Object(k.jsxs)(ce,{children:[Object(k.jsx)("label",{htmlFor:e,children:e}),Object(k.jsx)("input",{type:"text",value:a[e],onChange:function(t){return c(e,t.target.value)},id:e})]},e)})),Object(k.jsxs)(ce,{children:[Object(k.jsx)("label",{htmlFor:"start-date",children:"Start Date"}),Object(k.jsx)("input",{type:"date",value:a.startDate,onChange:function(e){return c("startDate",e.target.value)},id:"start-date"})]}),Object(k.jsxs)(ce,{children:[Object(k.jsx)("label",{htmlFor:"finish-date",children:"Finish Date"}),Object(k.jsx)("input",{type:"date",value:a.finishDate,onChange:function(e){return c("finishDate",e.target.value)},id:"finish-date"})]}),Object(k.jsx)(B,{onClick:function(){return function(){if(t){var n=Object(I.a)({},a);n.startDate=Math.floor(new Date(n.startDate).getTime()/1e3),n.finishDate=Math.floor(new Date(n.finishDate).getTime()/1e3),oe(n.question,n.answer1,n.answer2,n.answer3,n.answer4,n.startDate,n.finishDate).then((function(t){e.push("/")})).catch((function(e){console.log(e)}))}else D()("Error","Connect to your wallet!","error")}()},disabled:!(""!==a.question.trim()&&""!==a.answer1.trim()&&""!==a.answer2.trim()&&""!==a.answer3.trim()&&""!==a.answer4.trim()&&""!==a.startDate.trim()&&""!==a.finishDate.trim()&&a.startDate.trim()>=(new Date).toISOString().slice(0,10)&&a.startDate.trim()<a.finishDate.trim()),children:"Save"})]})},se=function(){return Object(k.jsx)("h1",{children:"NotFound"})};var le=function(){return Object(k.jsx)("div",{children:Object(k.jsxs)(w.a,{children:[Object(k.jsx)(S,{}),Object(k.jsxs)(O.c,{children:[Object(k.jsx)(O.a,{path:"/create-poll",children:Object(k.jsx)(ie,{})}),Object(k.jsx)(O.a,{path:"/poll/:index",component:re}),Object(k.jsx)(O.a,{path:"/",exact:!0,children:Object(k.jsx)(q,{})}),Object(k.jsx)(O.a,{path:"/",children:Object(k.jsx)(se,{})})]})]})})};j.a.render(Object(k.jsx)(x.a,{store:v,children:Object(k.jsx)(le,{})}),document.getElementById("root"))},52:function(e,t,n){"use strict";n.r(t),function(e){var t=n(2),r=n.n(t),a=n(25),o=n(117),c=n(94),i=function(){var e=o.providers.HttpProvider,t=new e(c.tronFullNode),n=new e(c.tronSolidityNode),r=new e(c.tronEventServer);return new o(t,n,r,c.tronGeneralPrivateKey)},s=function(){if(window&&window.tronWeb&&window.tronWeb.defaultAddress.base58)return window.tronWeb},l=function(){var e=Object(a.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="general"===n?i():s(),e.abrupt("return",a.contract().at(t));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),u=function(){var e=Object(a.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i(),e.abrupt("return",n.trx.getTransactionInfo(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.exports.getGeneralTronWeb=i,e.exports.getTronContract=l,e.exports.tronHexToAscii=function(e){return o.toAscii(e)},e.exports.tronHexToDecimal=function(e){return o.toDecimal(e)},e.exports.getUserTronWallet=function(){if(window.tronWeb&&window.tronWeb.defaultAddress.base58)return window.tronWeb.defaultAddress.base58},e.exports.getTransactionInfo=u}.call(this,n(65)(e))},58:function(e,t,n){"use strict";n.r(t),function(e){var t=n(2),r=n.n(t),a=n(25),o=n(52),c=n(94),i=function(){var e=Object(a.a)(r.a.mark((function e(t,n,a,i,s,l,u){var d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getTronContract(c.tronPollDappContract,"user");case 2:return d=e.sent,e.prev=3,e.next=6,d.createPoll(t,n,a,i,s,l,u).send();case 6:return p=e.sent,e.abrupt("return",p);case 10:e.prev=10,e.t0=e.catch(3),console.log("error",e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,n,r,a,o,c,i){return e.apply(this,arguments)}}(),s=function(){var e=Object(a.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getTronContract(c.tronPollDappContract,"general");case 2:return n=e.sent,e.next=5,n.polls(t).call();case 5:return(a=e.sent).startDate=o.tronHexToDecimal(a.startDate._hex),a.finishDate=o.tronHexToDecimal(a.finishDate._hex),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(a.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getTronContract(c.tronPollDappContract,"general");case 2:return t=e.sent,e.next=5,t.getPollCount().call();case 5:return n=e.sent,e.abrupt("return",o.tronHexToDecimal(n._hex));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(a.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getTronContract(c.tronPollDappContract,"general");case 2:return n=e.sent,e.next=5,n.voteCounters(t).call();case 5:return(a=e.sent).answer1VoteCounter=o.tronHexToDecimal(a.answer1VoteCounter._hex),a.answer2VoteCounter=o.tronHexToDecimal(a.answer2VoteCounter._hex),a.answer3VoteCounter=o.tronHexToDecimal(a.answer3VoteCounter._hex),a.answer4VoteCounter=o.tronHexToDecimal(a.answer4VoteCounter._hex),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(a.a)(r.a.mark((function e(t,n){var a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getTronContract(c.tronPollDappContract,"user");case 2:return a=e.sent,e.prev=3,e.next=6,a.vote(t,n).send();case 6:return i=e.sent,e.abrupt("return",i);case 10:e.prev=10,e.t0=e.catch(3),console.log("error",e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,n){return e.apply(this,arguments)}}(),p=function(){var e=Object(a.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.getTronContract(c.tronPollDappContract,"general");case 2:return t=e.sent,e.prev=3,e.next=6,t.setToken(c.tronPollTokenContract).send();case 6:return n=e.sent,e.abrupt("return",n);case 10:e.prev=10,e.t0=e.catch(3),console.log("error",e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(){return e.apply(this,arguments)}}();e.exports.createPoll=i,e.exports.getPoll=s,e.exports.vote=d,e.exports.getVoteCounter=u,e.exports.getPollCount=l,e.exports.setToken=p}.call(this,n(65)(e))},94:function(e,t){var n=[{publicKey:"TG31Eya5GywMYV2rwq3rwGbep4eoykWREP",privateKey:"d8db4dfed48fc23884a1bde2e654cf7e6498ad023892ddbafb3c013573e2bd74"},{publicKey:"TTH598f947PU5sXz33PmfPPergcw11jy2S",privateKey:"feddacfb92d2817811cee05947ee48a2733e746c6309d8101d248df78cdf7679"},{publicKey:"TW9srDmAC2ydc8WfNaLYMnS63iQiWKfgLG",privateKey:"fccd3e23c114644d002013f69d3cd0d1d6e8261989b3131d3d02a507e7b4f018"},{publicKey:"TT88NtTzYT56fG7avWGrgBkDvrY6MX7rWb",privateKey:"378c5553f4ed02b995e5395c3057f2b6bc72b26a854e8353fc2211daa9ff1a20"},{publicKey:"TG6i13mQLMM7SrfD8TRSxxDZBQEpUizShs",privateKey:"a7c2179a95ea189914517c43adf7b9e130ee27c14e2e81f55975be5b1d59c869"},{publicKey:"TQnwk8eSZjFVH9JhzKkaPnV27r6Xxhg4u1",privateKey:"a2cc6886212962255777cb1fcc393d12613e60cea4f95877ad1b1bb7e75e8f29"},{publicKey:"THagkrFvo2xoASnRgpsMqvusBdAn7DQTcc",privateKey:"bea9b1682374a15c351704b27c221155759f72fefaec2d9d52054ebb35569363"},{publicKey:"TPiBEmProxmvwuEbPkYe8WCE5EEAHM5zeg",privateKey:"7d134b76c1a878bc0318c8d1aacb6f41c46d1ba9a8d8ba2f2cd95b9a81cbc430"},{publicKey:"TCXaE1cAYbHM9X3Q8mKDAWU3rq7mPb1vxt",privateKey:"4d4695179f5190a53eaa3b1d7cda972f385fafaff2bd90011f67c7c83aa2a7c3"},{publicKey:"TWEPD2Li4R4NQ4GrrrWBp4bK7xgsaHs24W",privateKey:"5c6c45c09715d1b34249b1b7238c8b1a14e7ffbe71d331caa90c6a2017ebe178"}],r=n[0].publicKey,a=n[0].privateKey;e.exports.tronPollDappContract="TJ8MBRtmiArKmMDZPP5itVwesHSbAPCJhY",e.exports.tronPollTokenContract="TLgt7Zkh56mJvqVFAYyshgvYMqjk14gXSk",e.exports.tronAccounts=n,e.exports.tronFullNode="https://api.shasta.trongrid.io",e.exports.tronSolidityNode="https://api.shasta.trongrid.io",e.exports.tronEventServer="https://api.shasta.trongrid.io",e.exports.tronGeneralPublicKey=r,e.exports.tronGeneralPrivateKey=a}},[[252,1,2]]]);
//# sourceMappingURL=main.2fde4917.chunk.js.map